<div style="border:1px solid; max-width: 400px">
 <u>
  Table of Contents
 </u>
 <ul>
  <ul>
   <li>
    <a href="lib/README.md">
     Lib
    </a>
    <ul>
     <li>
      <a href="lib/README.md#goal">
       Goal
      </a>
     </li>
     <li>
      <a href="lib/README.md#journey">
       Journey
      </a>
     </li>
     <li>
      <a href="lib/README.md#how-it-works">
       How it works
      </a>
      <ul>
       <li>
        <a href="lib/README.md#initialization">
         Initialization
        </a>
       </li>
       <li>
        <a href="lib/README.md#loading-pbix-to-ssas">
         Loading PBIX to SSAS
        </a>
       </li>
       <li>
        <a href="lib/README.md#saving-pbix-from-ssas">
         Saving PBIX from SSAS
        </a>
       </li>
       <li>
        <a href="lib/README.md#extracting-schema">
         Extracting Schema
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="lib/README.md#examples">
       Examples
      </a>
      <ul>
       <li>
        <a href="lib/README.md#updating-powerbi">
         Updating PowerBI
        </a>
       </li>
       <li>
        <a href="lib/README.md#getting-schema-information">
         Getting Schema Information
        </a>
       </li>
       <li>
        <a href="lib/README.md#power-query-parser">
         Power Query Parser
        </a>
       </li>
       <li>
        <a href="lib/README.md#dax-parser">
         Dax Parser
        </a>
       </li>
       <li>
        <a href="lib/README.md#contributions">
         Contributions
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
  <ul>
   <li>
    <a href="load_to_db/README.md">
     Load To Db
    </a>
    <ul>
     <li>
      <a href="load_to_db/README.md#schema">
       Schema
      </a>
      <ul>
       <li>
        <a href="load_to_db/README.md#parsed-fields">
         Parsed Fields
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#annotations">
         Annotations
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#examples">
           Examples
          </a>
         </li>
         <li>
          <a href="load_to_db/README.md#sample-queries">
           Sample Queries
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#columns">
         Columns
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#data-sources">
         Data Sources
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#examples_1">
           Examples
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#expressions">
         Expressions
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#examples_2">
           Examples
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#hierarchies">
         Hierarchies
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#levels">
         Levels
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#example">
           Example
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#linguistic-metadata">
         Linguistic Metadata
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#example_1">
           Example
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#measures">
         Measures
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#example_2">
           Example
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#pages">
         Pages
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#partitions">
         Partitions
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#relationships">
         Relationships
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#example_3">
           Example
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#reports">
         Reports
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#tables">
         Tables
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#visuals">
         Visuals
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#examples_3">
           Examples
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#static-fields">
         Static Fields
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#annotation-object-types">
         Annotation Object Types
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#sample">
           Sample
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#datatypes">
         Datatypes
        </a>
        <ul>
         <li>
          <a href="load_to_db/README.md#sample_1">
           Sample
          </a>
         </li>
        </ul>
       </li>
       <li>
        <a href="load_to_db/README.md#relationship-cardinalities">
         Relationship Cardinalities
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#relationship-crossfilter-types">
         Relationship Crossfilter Types
        </a>
       </li>
       <li>
        <a href="load_to_db/README.md#views">
         Views
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="load_to_db/README.md#example_4">
       Example
      </a>
     </li>
     <li>
      <a href="load_to_db/README.md#facts">
       Facts
      </a>
     </li>
     <li>
      <a href="load_to_db/README.md#developers">
       Developers
      </a>
     </li>
    </ul>
   </li>
  </ul>
  <ul>
   <li>
    <a href="visualizer/README.md">
     Visualizer
    </a>
    <ul>
     <li>
      <a href="visualizer/README.md#goal">
       Goal
      </a>
     </li>
     <li>
      <a href="visualizer/README.md#frontend">
       frontend
      </a>
      <ul>
       <li>
        <a href="visualizer/README.md#recommended-ide-setup">
         Recommended IDE Setup
        </a>
       </li>
       <li>
        <a href="visualizer/README.md#customize-configuration">
         Customize configuration
        </a>
       </li>
       <li>
        <a href="visualizer/README.md#project-setup">
         Project Setup
        </a>
        <ul>
         <li>
          <a href="visualizer/README.md#compile-and-hot-reload-for-development">
           Compile and Hot-Reload for Development
          </a>
         </li>
         <li>
          <a href="visualizer/README.md#compile-and-minify-for-production">
           Compile and Minify for Production
          </a>
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </ul>
</div>

# Goals

PowerBI is one of the top visualization tools out there. However, it lacks a number of data adminstration-type abilities. The goal of this project is to fill some of these holes, such as:

1. Creating a low-level python interface with PowerBI's SSAS backend. Specifically, we'd like people to be able to schedule local data refreshes. We'd also like to expose the DataModel's schema as a JSON without needing to think about SSAS.
2. Identifying report lineage. Some reports are frankensteined from previous reports. We hope to be able use the table, datasource, measure, and visual IDs to identify reports that share a relationship
3. Allowing people to query PBIX datamodel information with SQL
4. Creating a tool for analysts to allow them to view reports using the same datasources/measures as they are.
5. A data lineage tool for DEs allowing them to connect datasources to individual visuals in each report.

# Details

[Extract Lib](lib/README.md)

[Schema Parser](load_to_db/README.md)

[Schema Visualizer](visualizer/README.md)

# Set Up

```
pip install -r requirements.txt
cd lib
python setup.py sdist
```

# Dev extras

Has a black pre-commit hook

```
git config core.hooksPath hooks
```

# Demo

Uses a docker image
`docker build . -t demo`
`docker run -p 22:22 -p 100:100 -p 5000:5000 -p 5433:5432 demo`


# Help
Expressions are DAX-generated tables

Don't understand `ExtendedProperty`, see `Income share held by lowest 20%` in `c:/Users/mwham/Documents/repos/powerbi-decompressor/pbis/Life expectancy v202009.pbix`

Don't understand variations, see `c:/Users/mwham/Documents/repos/powerbi-decompressor/pbis/Sales & Returns Sample v201912.pbix`